<!DOCTYPE html>
<!-- saved from url=(0106)https://tianchi.aliyun.com/mas-notebook/preview/104553/bd804f20-cfbe-11ea-8e69-d78ca3f06e1f.ipynb/-1?lang= -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>notebook</title>
  <link rel="icon" id="favicon" href="https://s.tianchi.aliyun.com/mas-notebook/assets/logo.ico" type="image/x-icon">
  <link nonce="" rel="stylesheet" href="./katex.min.css">
  <link rel="stylesheet" href="./app.70f3251749.css">
  <link nonce="" href="./font-awesome.min.css" rel="stylesheet">
  <script nonce="" id="jupyter-config-data" type="application/json">{
    "devMode": "False",
    "notebookVersion": "[5, 7, 0]",
    "mathjaxConfig": "TeX-AMS_CHTML-full,Safe",
     "mathjaxUrl": "https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/MathJax.js",
    "appVersion": "0.35.0"
    }</script>
  <script nonce="">
    // 1. csrf
    window.ajaxHeader = {
      'x-csrf-token': 'lbUgxSiV-vgDgEXMCn9Z1TJJw4Ka5u-dhk6o'
    };
    window.user = {};
    window.l20n = {};
    window.navigator.defaultLanguageMessage = {"notebook.addMessage.duplicate":"添加重复","notebook.addMessage.failed":"添加失败","notebook.addMessage.success":"添加成功","notebook.ajax.defaultErrorTitle":"接口错误","notebook.ajax.networkErrorTitle":"网络不给力，刚才的操作失败啦o(╥﹏╥)o 请稍后重试~","notebook.applyGpu.access":" 天的GPU使用权限，使用时将扣除您 ","notebook.applyGpu.audit":"通知您！审核通过将开放","notebook.applyGpu.complete":"我们会在","notebook.applyGpu.getToken":"去赚粮票","notebook.applyGpu.letter":"站内信","notebook.applyGpu.possible":"粮票哦~","notebook.applyGpu.result":"内完成审批，审批结果将通过","notebook.applyGpu.toEarn":"粮票，审核过程中建议您尽快赚满","notebook.applyGpu.workdays":"7个工作日","notebook.applygpu.applyForm":"GPU申请表","notebook.applygpu.applyReasons":"申请原因","notebook.applygpu.applyUserName":"姓名","notebook.applygpu.ckeckToken":"请确认粮票数后填写","notebook.applygpu.company":"所在公司名称或学校名称","notebook.applygpu.contactEmail":"邮箱","notebook.applygpu.contactNum":"联系电话","notebook.applygpu.datasestDesc":"所用数据集描述","notebook.applygpu.datasestName":"所用数据集名称","notebook.applygpu.datasestSence":"实验场景描述","notebook.applygpu.datasestSize":"所用数据集大小","notebook.applygpu.deduct":"通过申请后，需要扣除您的","notebook.applygpu.degree":"学历","notebook.applygpu.educationIsNull":"学历不能为空哦!","notebook.applygpu.emailIsError":"邮箱格式错误!","notebook.applygpu.emailIsNull":"邮箱不能为空哦!","notebook.applygpu.estimation":"基于单张P100估计所需要的计算时长","notebook.applygpu.gotoCkeckToken":"点击查看我的粮票数","notebook.applygpu.haveApply":"您已经申请过了哦","notebook.applygpu.location":"所在地","notebook.applygpu.modelInfo":"使用到模型详细描述","notebook.applygpu.myTokenNum":"我现有的粮票","notebook.applygpu.nameIsNull":"姓名不能为空哦!","notebook.applygpu.notbookNumIsNull":"notebook数量不能为空哦！","notebook.applygpu.personalInfos":"若您有个人的项目github地址、公众号、博客等，可以在这里填写哦","notebook.applygpu.phoneHasOther":"联系电话不能带“-”哦'","notebook.applygpu.phoneIsError":"联系电话格式错误","notebook.applygpu.phoneIsNull":"联系电话不能为空哦!","notebook.applygpu.placeIsNull":"所在地不能为空哦!","notebook.applygpu.publicNotebookNum":"已公开的notebook数量","notebook.applygpu.reasonIsNull":"申请理由不能为空哦!","notebook.applygpu.schollIsNull":"所在公司或学校不能为空哦!","notebook.applygpu.sureOpen":"粮票才能够开启GPU，请确保已经赚到足够的粮票哦~。通过发帖/notebook、评论等都可以赚粮票，现在就","notebook.applygpu.tokenIsNull":"我的粮票不能为空哦!","notebook.applygpu.tokenIsNum":"粮票数应为数字哦!","notebook.applygpu.tokenNumIsError":"粮票数量不正确","notebook.applygpu.uploadPDF":"请上传PDF格式文件","notebook.applygpu.uploadResumes":"上传简历","notebook.applygpu.youOtherDesc":"您的其他描述","notebook.common.add":"添加","notebook.common.close":"关闭","notebook.common.formatError":"格式不正确","notebook.common.none":"无","notebook.common.uploadFaild":"上传失败","notebook.common.uploadSuccess":"上传成功","notebook.dataDetail.confirm.delete.got":"知道了","notebook.dataDetail.confirm.delete.haveDeily":"您已延时过了，不能再延时！","notebook.dataDetail.confirm.deletion.useGpu":"使用GPU将扣除","notebook.dataDetail.deleteData.success":"删除成功，十秒后生效哦～","notebook.dataDetail.fileDelete.deletefailed":"删除失败","notebook.dataset.continueRelease":"继续发布","notebook.dataset.dataList":"挂载数据","notebook.dataset.dataName":"名称","notebook.dataset.dataPostedBy":"发布者","notebook.dataset.datalist":"数据列表","notebook.dataset.description":"描述","notebook.dataset.expired":"已过期","notebook.dataset.failed":"创建数据集失败，请稍后重试","notebook.dataset.fileList":"个人空间","notebook.dataset.newData":"新建数据","notebook.dataset.noData":"还没有数据哦～","notebook.dataset.priDataDialogCon":"由于所使用的数据集为私有权限，公开后其他用户将无法fork到该notebook的数据哦。","notebook.dataset.publicData":"公开数据","notebook.dataset.remarks":"注：若您未能在该列表中找到已报名的某些比赛数据，说明该比赛数据不支持直接挂载到天池notebook。","notebook.dataset.sureDelete":"确定删除","notebook.datasetList.dataset":"数据集","notebook.datasetList.dataset.addPublish":"仅可挂载已发布的数据集哦","notebook.datasetList.dataset.competition":"参加比赛数据","notebook.datasetList.dataset.my":"我的数据集","notebook.datasetList.dataset.publish":"公有数据集","notebook.edit.cancel":"取消","notebook.edit.catalog":"目录","notebook.edit.catalogEmpty":"目录为空","notebook.edit.choiceCell":"请选择运行的cell","notebook.edit.comfirm":"确定","notebook.edit.comfirmVersion":"确定发布版本？","notebook.edit.competition":"亲~需要关联比赛吗？若不需要可选择“无”","notebook.edit.content":"确定连接kernel吗","notebook.edit.defaultTitle":"请修改标题","notebook.edit.des":"亲~输出的结果已经超过限制了哦，无法保存，请精简输出吧o(*￣︶￣*)o","notebook.edit.emptyTitle":"标题不能为空！","notebook.edit.errkernel":"2月份系统维护升级期间，将造成kernel无法正常连接，代码将无法运行，给您带来的不便深表歉意。","notebook.edit.inthequeue":"kernel正在排队中，请耐心等待哦~","notebook.edit.keepRunning":"是否继续运行cell","notebook.edit.limitTitle":"标题应大于10个字符长度","notebook.edit.linkCompetition":"关联比赛","notebook.edit.linkCompetitionFirt":"请先关联比赛","notebook.edit.maxTitle":"标题长度不可以超过120个字符哦~","notebook.edit.sameTitle":"标题重复","notebook.edit.saveContent":"请先保存内容再发布版本","notebook.edit.saveErr":"保存失败，请稍后重试","notebook.edit.saveFail":"保存失败","notebook.edit.saveSuccess":"保存成功","notebook.edit.shutcontent":"确定断开kernel吗？","notebook.edit.submit":"提交","notebook.edit.tip":"提示","notebook.edit.versionFail":"版本发布失败，请稍后重试","notebook.edit.versionSuccess":"版本发布成功","notebook.edit.warnConnectKernel":"连接kernel后，可以进行代码补全哦~","notebook.empty.message":"您访问的文档不存在或没有权限","notebook.ipython_editor.input_con.none":"无","notebook.ipython_editor.inpyt_con.placeholder":"请输入项目标题","notebook.ipython_editor.operation_bar.close":"关闭","notebook.ipython_editor.operation_bar.delay":"延时","notebook.ipython_editor.operation_bar.delayaffter":"个粮票，单次连接只可延时1次，1次为","notebook.ipython_editor.operation_bar.delaybefore":"断开前30分钟和15分钟系统会分别提示是否延时，延时将扣除","notebook.ipython_editor.operation_bar.disconnect":"后断开","notebook.ipython_editor.operation_bar.disconnects":"断开","notebook.ipython_editor.operation_bar.hour":"小时","notebook.ipython_editor.operation_bar.isDelay":"已延时","notebook.ipython_editor.operation_bar.kernelDisconnect":"剩余","notebook.ipython_editor.operation_bar.kerneltime.hover":"单次连接时长为2小时，可多次连接，连接断开后您的所有中间结果将被清除。","notebook.ipython_editor.operation_bar.linkCompetition":"关联比赛","notebook.ipython_editor.operation_bar.none":"无","notebook.ipython_editor.operation_bar.shoutKey":"notebook快捷键","notebook.ipython_editor.operator_bar.cellType.code":"code","notebook.ipython_editor.operator_bar.cellType.markdown":"markdown","notebook.ipython_editor.private":"私有","notebook.ipython_editor.public":"公开","notebook.ipython_editor.tip":"公开后不能再设为私有哦～","notebook.login.tip":"请先登录！","notebook.manage.prompt":"温馨提示","notebook.networkMessage.reload":"重新加载","notebook.newNotebook.addDatasetbtn":"添加数据集","notebook.newNotebook.applyAgain":"未通过，再次申请：","notebook.newNotebook.applyFail":"未通过","notebook.newNotebook.applying":"GPU申请中...","notebook.newNotebook.closeGpu":"确定关闭GPU？","notebook.newNotebook.deduction":"，扣除","notebook.newNotebook.deductionAndDelay":"粮票，是否扣除并延时？","notebook.newNotebook.delayHour":"小时","notebook.newNotebook.delayToken":",您的粮票不足","notebook.newNotebook.earntoken":"请先赚取粮票。","notebook.newNotebook.gpuapply":"申请GPU","notebook.newNotebook.kernel":"您的kernel连接将在","notebook.newNotebook.kernelTime":"分钟后断开","notebook.newNotebook.runningGpu":"关闭GPU会中断当前运行，是否确认关闭？","notebook.newNotebook.to":"至","notebook.newNotebook.tokenDelay":"个粮票将可以延时","notebook.newNotebook.tokens":"粮票","notebook.newNotebook.willdeduction":"延时GPU将扣除","notebook.newNotebook.work":"有效","notebook.newNotebook.you":"，您还有","notebook.release.version":"发布版本","notebook.submit.submitfailed":"您的比赛答案提交失败，请稍后重试。","notebook.submit.submitfilecontent":"您的比赛答案已提交成功","notebook.submit.submitsuccess":"提交成功","notebook.submit.viewsubmit":"查看提交","notebook.submitFile.submitContent":"提交比赛至","notebook.submitFile.submitTitle":"提交文件至比赛","notebook.submitFile.submitTitles":"提交文件至比赛","notebook.submitcompetition.notable":"您还没有参加过比赛，请先参加比赛。","notebook.submitfile.canotsubmit":"提交失败","notebook.submitfile.canotsubmitcontent":"该比赛已经不能提交文件,请选择其他比赛。","notebook.vip.noKernelOpenGpu":"确认打开GPU？","notebook.vip.onKernelOpenGpu":"连接GPU将进行kernel重连，导致当前运行程序的中间结果失效，确认打开？"};
    window.navigator.toObserver = true;
    // 2. env
    window.CONFIG = {};
    window.CONFIG.language = 'zh-cn';
    window.CONFIG.isDebug = false;
    window.CONFIG.notebookCanEdit = true;
    window.CONFIG.hasKernel = true;
    window.CONFIG.hasFileManager = true;
    window.CONFIG.hasGPU = true;
    window.CONFIG.userId = '';
    window.CONFIG.prefix = '/mas-notebook';
    window.CONFIG.appName = 'mas-notebook';
    window.CONFIG.currentVip = 'false';
    var hostname = window.location.hostname.split('.');
    var len = hostname.length;
    hostname = hostname.slice(len - 3, len).join('.');
    document.domain = hostname;
  </script>
<style id="b1rh9mb"></style><script type="text/javascript" src="./MathJax.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-full-width {text-align: center; display: table-cell!important; width: 10000em}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; -webkit-box-sizing: content-box!important; -moz-box-sizing: content-box!important; box-sizing: content-box!important; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: table-row}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: inline}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table; width: auto}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-chartest {display: block; visibility: hidden; position: absolute; top: 0; line-height: normal; font-size: 500%}
.mjx-chartest .mjx-char {display: inline}
.mjx-chartest .mjx-box {padding-top: 1000px}
.MJXc-processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MJXc-processed {display: none}
.mjx-test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.mjx-test.mjx-test-display {display: table!important}
.mjx-test.mjx-test-inline {display: inline!important; margin-right: -1px}
.mjx-test.mjx-test-default {display: block!important; clear: both}
.mjx-ex-box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.mjx-test-inline .mjx-left-box {display: inline-block; width: 0; float: left}
.mjx-test-inline .mjx-right-box {display: inline-block; width: 0; float: right}
.mjx-test-display .mjx-right-box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
#MathJax_CHTML_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.mjx-chtml .mjx-noError {line-height: 1.2; vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
.MJXc-TeX-unknown-R {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
.MJXc-TeX-vec-R {font-family: MJXc-TeX-vec-R,MJXc-TeX-vec-Rw}
.MJXc-TeX-vec-B {font-family: MJXc-TeX-vec-B,MJXc-TeX-vec-Bx,MJXc-TeX-vec-Bw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-vec-R; src: local('MathJax_Vector'), local('MathJax_Vector-Regular')}
@font-face {font-family: MJXc-TeX-vec-Rw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Vector-Regular.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Vector-Regular.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Vector-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-vec-B; src: local('MathJax_Vector Bold'), local('MathJax_Vector-Bold')}
@font-face {font-family: MJXc-TeX-vec-Bx; src: local('MathJax_Vector'); font-weight: bold}
@font-face {font-family: MJXc-TeX-vec-Bw; src /*1*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/eot/MathJax_Vector-Bold.eot'); src /*2*/: url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Vector-Bold.woff') format('woff'), url('https://g.alicdn.com/tc/tianchi-com-assets/0.0.14/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Vector-Bold.otf') format('opentype')}
</style></head>
<body><div id="MathJax_Message" style="display: none;"></div><script>
with(document)with(body)with(insertBefore(createElement("script"),firstChild))setAttribute("exparams","category=&userid=&aplus&yunid=%22ybka%2a%2a%2a%2a%22&5fa175984be79&asid=AQAAAABHV/xfYiuLagAAAABqBAAc08iNfQ==",id="tb-beacon-aplus",src=(location>"https"?"//g":"//g")+".alicdn.com/alilog/mlog/aplus_v2.js")
</script>

  <div id="main" style="padding: 0px;"><div class="notebook-wrapper"><div class="notebook-preview"><div class="warpper" style="height: 100%;"><div class=" toc-wrap"><div class="toc-head">目录&nbsp;<i aria-label="icon: up-circle" class="anticon anticon-up-circle"><svg viewBox="64 64 896 896" focusable="false" class="" data-icon="up-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M518.5 360.3a7.95 7.95 0 0 0-12.9 0l-178 246c-3.8 5.3 0 12.7 6.5 12.7H381c10.2 0 19.9-4.9 25.9-13.2L512 460.4l105.2 145.4c6 8.3 15.6 13.2 25.9 13.2H690c6.5 0 10.3-7.4 6.5-12.7l-178-246z"></path><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"></path></svg></i></div><div class="toc"><a class="level_1" href="https://tianchi.aliyun.com/mas-notebook/preview/104553/bd804f20-cfbe-11ea-8e69-d78ca3f06e1f.ipynb/-1?lang=#%E4%BD%BF%E7%94%A8gensim%E8%AE%AD%E7%BB%83word2vec" title="使用gensim训练word2vec">使用gensim训练word2vec</a></div></div><div class="p-Widget p-Panel p-BoxPanel" data-direction="top-to-bottom" data-alignment="start" id="root-panel" style="min-width: 0px; min-height: 86px;"><div class="p-Widget p-Panel p-BoxPanel-child" id="top-panel" style="position: absolute; top: 0px; left: 0px; width: 876px; height: 48px;"><div class="p-Widget"><div class="input-top"><div class="isSave" id="isSave"></div><div class="edit-area"><input id="contentTitle" title="" placeholder="请输入项目标题" value=""></div><div id="title" style="display: none;"></div><div class="edit-btnContainer"><div class="lang-sel"><div class="ant-select ant-select-enabled"><div class="ant-select-selection
            ant-select-selection--single" role="combobox" aria-autocomplete="list" aria-haspopup="true" aria-controls="52ebf250-b588-4227-efae-0649fff48367" aria-expanded="false" tabindex="0"><div class="ant-select-selection__rendered"><div class="ant-select-selection-selected-value" title="PYTHON3" style="display: block; opacity: 1;">PYTHON3</div></div><span class="ant-select-arrow" unselectable="on" style="user-select: none;"><i aria-label="icon: down" class="anticon anticon-down ant-select-arrow-icon"><svg viewBox="64 64 896 896" focusable="false" class="" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></div></div></div><div class="float-right"><div class="ant-select ant-select-enabled"><div class="ant-select-selection
            ant-select-selection--single" role="combobox" aria-autocomplete="list" aria-haspopup="true" aria-controls="0455578d-7552-44df-87c1-1c64f464b792" aria-expanded="false" tabindex="0"><div class="ant-select-selection__rendered"><div class="ant-select-selection-selected-value" title="关联比赛" style="display: block; opacity: 1;">关联比赛</div></div><span class="ant-select-arrow" unselectable="on" style="user-select: none;"><i aria-label="icon: down" class="anticon anticon-down ant-select-arrow-icon"><svg viewBox="64 64 896 896" focusable="false" class="" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></div></div></div><div class="switch"><button type="button" role="switch" aria-checked="false" class="switchBtn ant-switch"><span class="ant-switch-inner"></span></button><span class="switchTxt">私有</span></div><div class="versionContainer"><button type="button" class="ant-btn releasebtn ant-btn-primary"><span>发布版本</span></button></div></div></div></div></div><div class="p-Widget p-DockPanel p-BoxPanel-child" data-mode="multiple-document" style="position: absolute; min-width: 0px; min-height: 38px; top: 48px; left: 0px; width: 876px; height: 1890px;"><div class="p-DockPanel-overlay p-mod-hidden" style="position: absolute;"></div><div class="p-Widget p-TabBar p-DockPanel-tabBar p-mod-hidden" data-orientation="horizontal" style="position: absolute;"><ul class="p-TabBar-content"><li title="" class="p-TabBar-tab p-mod-current" style="z-index: 1;"><div class="p-TabBar-tabIcon jp-NotebookIcon"></div><div class="p-TabBar-tabLabel">Notebook</div><div class="p-TabBar-tabCloseIcon"></div></li></ul></div><div class="p-Widget p-Panel p-StackedPanel p-DockPanel-widget" id="main-panel" style="position: absolute; min-width: 0px; min-height: 0px; top: 0px; left: 0px; width: 876px; height: 1890px;"><div class="p-Widget jp-MainAreaWidget jp-NotebookPanel jp-Document p-StackedPanel-child" id="78c2eea8-7800-4834-827d-0fe2a294b0ce" data-direction="top-to-bottom" data-alignment="start" style="position: absolute; min-width: 0px; min-height: 0px; z-index: 0; top: 0px; left: 0px; width: 876px; height: 1890px;"><div class="p-Widget jp-Toolbar jp-NotebookPanel-toolbar nbToolbar" style="position: absolute; top: 0px; left: 0px; width: 876px; height: 0px; min-height: var(--jp-private-toolbar-height);"><div class="p-Widget jp-Toolbar-item"><div title="save" class="jp-SaveIcon jp-Icon jp-Icon-16 my-toolbaricon jp-noSave"></div></div><div class="p-Widget jp-ToolbarButton jp-Toolbar-item"><button class="jp-ToolbarButtonComponent" title="exec selected cell"><span class="jp-RunIcon jp-Icon jp-Icon-16 my-toolbaricon jp-ToolbarButtonComponent-icon"></span></button></div><div class="p-Widget jp-ToolbarButton jp-Toolbar-item"><button class="jp-ToolbarButtonComponent" title="exec all cells"><span class="jp-RunAllIcon jp-Icon jp-Icon-16 my-toolbaricon jp-ToolbarButtonComponent-icon"></span></button></div><div class="p-Widget jp-ToolbarButton jp-Toolbar-item"><button class="jp-ToolbarButtonComponent" title="restart &amp; clear output"><span class="jp-ClearIcon jp-Icon jp-Icon-16 my-toolbaricon jp-ToolbarButtonComponent-icon"></span></button></div><div class="p-Widget jp-ToolbarButton jp-Toolbar-item"><button class="jp-ToolbarButtonComponent" title="interrupt the cell"><span class="jp-StopIcon jp-Icon jp-Icon-16 my-toolbaricon jp-ToolbarButtonComponent-icon"></span></button></div><div class="p-Widget jp-ToolbarButton jp-Toolbar-item"><button class="jp-ToolbarButtonComponent" title="new code cell"><span class="jp-AddIcon jp-Icon jp-Icon-16 my-toolbaricon jp-ToolbarButtonComponent-icon"></span></button></div><div class="p-Widget jp-ToolbarButton jp-Toolbar-item"><button class="jp-ToolbarButtonComponent" title="new markdown cell"><span class="jp-AddMDIcon jp-Icon jp-Icon-16 my-toolbaricon jp-ToolbarButtonComponent-icon"></span></button></div><div class="p-Widget jp-ToolbarButton jp-Toolbar-item"><button class="jp-ToolbarButtonComponent" title="move down"><span class="jp-MoveDownIcon jp-Icon jp-Icon-16 my-toolbaricon jp-ToolbarButtonComponent-icon"></span></button></div><div class="p-Widget jp-ToolbarButton jp-Toolbar-item"><button class="jp-ToolbarButtonComponent" title="move up"><span class="jp-MoveUpIcon jp-Icon jp-Icon-16 my-toolbaricon jp-ToolbarButtonComponent-icon"></span></button></div><div class="p-Widget jp-ToolbarButton jp-Toolbar-item"><button class="jp-ToolbarButtonComponent" title="keyboard shortcuts"><span class="jp-ShotcustIcon jp-Icon jp-Icon-16 my-toolbaricon jp-ToolbarButtonComponent-icon"></span></button></div><div class="p-Widget jp-Toolbar-item"><div title="connect or shutdown" class="jp-UnconnectIcon jp-Icon jp-Icon-16 my-toolbaricon"></div></div><div class="p-Widget jp-Toolbar-kernelStatus jp-Toolbar-item"><div class="kernelStatusbox jp-FilledCircleIcon"><div class="">disconnected</div></div></div><div class="p-Widget jp-time jp-Toolbar-item"></div></div><div class="p-Widget jp-Notebook jp-NotebookPanel-notebook jp-mod-commandMode" data-jp-kernel-user="true" data-jp-undoer="true" tabindex="-1" data-p-dragscroll="true" id="59abf1bb-7e60-4d64-92ec-fa9d5c472884" style="position: absolute; top: 0px; left: 0px; width: 876px; height: 1890px;"><div class="p-Widget jp-Cell jp-MarkdownCell jp-Notebook-cell jp-mod-active jp-mod-selected jp-mod-rendered jp-mod-readOnly"><div class="p-Widget jp-Cell-header"></div><div class="p-Widget p-Panel jp-Cell-inputWrapper"><div class="p-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="p-Widget jp-InputArea jp-Cell-inputArea"><div class="p-Widget jp-InputPrompt jp-InputArea-prompt"></div><div class="p-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor p-mod-hidden" data-type="inline"><div><div class="md-Toolbar"><span class=""><div class="ant-upload ant-upload-select ant-upload-select-text"><span tabindex="0" class="ant-upload" role="button"><input type="file" accept="" style="display: none;"><i class="jp-Icon md-Icon-16 my-toolbaricon md-imageIcon"></i></span></div></span><i class="jp-Icon md-Icon-16 my-toolbaricon md-tableIcon"></i><i class="jp-Icon md-Icon-16 my-toolbaricon  md-mathIcon"></i></div></div><div class="CodeMirror cm-s-jupyter CodeMirror-wrap jp-mod-readOnly"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea autocorrect="false" autocapitalize="false" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="display: block; bottom: 0px;"><div style="min-width: 1px; height: 56px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code" role="presentation"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="p-Widget jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown"><h1 id="%E4%BD%BF%E7%94%A8gensim%E8%AE%AD%E7%BB%83word2vec">使用gensim训练word2vec<a target="_self" href="https://tianchi.aliyun.com/mas-notebook/preview/104553/bd804f20-cfbe-11ea-8e69-d78ca3f06e1f.ipynb/-1?lang=#%E4%BD%BF%E7%94%A8gensim%E8%AE%AD%E7%BB%83word2vec" class="jp-InternalAnchorLink">¶</a></h1>
<p>本DEMO只使用部分数据，使用全部数据预训练的词向量地址：  </p>
<p>链接: <a rel="nofollow" href="https://pan.baidu.com/s/1ewlck3zwXVQuAzraZ26Euw" target="_blank">https://pan.baidu.com/s/1ewlck3zwXVQuAzraZ26Euw</a> 提取码: qbpr </p>
</div></div></div><div class="p-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="p-Widget jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-collapsed jp-mod-readOnly"><div class="p-Widget jp-Cell-header"></div><div class="p-Widget p-Panel jp-Cell-inputWrapper"><div class="p-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="p-Widget jp-InputArea jp-Cell-inputArea"><div class="p-Widget jp-InputPrompt jp-InputArea-prompt">[1]:</div><div class="p-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="CodeMirror cm-s-jupyter CodeMirror-wrap jp-mod-readOnly"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 43px;"><textarea autocorrect="false" autocapitalize="false" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 38px; margin-bottom: 0px; border-right-width: 30px; min-height: 248px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>14</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">logging</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">random</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">torch</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">logging</span>.<span class="cm-property">basicConfig</span>(<span class="cm-variable">level</span><span class="cm-operator">=</span><span class="cm-variable">logging</span>.<span class="cm-property">INFO</span>, <span class="cm-builtin">format</span><span class="cm-operator">=</span><span class="cm-string">'%(asctime)-15s %(levelname)s: %(message)s'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># set seed </span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">seed</span> <span class="cm-operator">=</span> <span class="cm-number">666</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">random</span>.<span class="cm-property">seed</span>(<span class="cm-variable">seed</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">seed</span>(<span class="cm-variable">seed</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">torch</span>.<span class="cm-property">cuda</span>.<span class="cm-property">manual_seed</span>(<span class="cm-variable">seed</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">torch</span>.<span class="cm-property">manual_seed</span>(<span class="cm-variable">seed</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 248px;"></div><div class="CodeMirror-gutters" style="left: 0px; height: 278px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="p-Widget p-Panel jp-Cell-outputWrapper"><div class="p-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="p-Widget jp-OutputArea jp-Cell-outputArea"><div class="p-Widget p-Panel jp-OutputArea-child jp-OutputArea-executeResult"><div class="p-Widget jp-OutputPrompt jp-OutputArea-prompt">[1]:</div><div class="p-Widget jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain"><pre>&lt;torch._C.Generator at 0x7fab09a064b0&gt;</pre></div></div></div></div><div class="p-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="p-Widget jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-collapsed jp-mod-readOnly"><div class="p-Widget jp-Cell-header"></div><div class="p-Widget p-Panel jp-Cell-inputWrapper"><div class="p-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="p-Widget jp-InputArea jp-Cell-inputArea"><div class="p-Widget jp-InputPrompt jp-InputArea-prompt">[2]:</div><div class="p-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="CodeMirror cm-s-jupyter CodeMirror-wrap jp-mod-readOnly"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 43px;"><textarea autocorrect="false" autocapitalize="false" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 38px; margin-bottom: 0px; border-right-width: 30px; min-height: 1506px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>88</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># split data to 10 fold</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fold_num</span> <span class="cm-operator">=</span> <span class="cm-number">10</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_file</span> <span class="cm-operator">=</span> <span class="cm-string">'../data/train_set.csv'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">all_data2fold</span>(<span class="cm-variable">fold_num</span>, <span class="cm-variable">num</span><span class="cm-operator">=</span><span class="cm-number">10000</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">fold_data</span> <span class="cm-operator">=</span> []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">f</span> <span class="cm-operator">=</span> <span class="cm-variable">pd</span>.<span class="cm-property">read_csv</span>(<span class="cm-variable">data_file</span>, <span class="cm-variable">sep</span><span class="cm-operator">=</span><span class="cm-string">'\t'</span>, <span class="cm-variable">encoding</span><span class="cm-operator">=</span><span class="cm-string">'UTF-8'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">texts</span> <span class="cm-operator">=</span> <span class="cm-variable">f</span>[<span class="cm-string">'text'</span>].<span class="cm-property">tolist</span>()[:<span class="cm-variable">num</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">labels</span> <span class="cm-operator">=</span> <span class="cm-variable">f</span>[<span class="cm-string">'label'</span>].<span class="cm-property">tolist</span>()[:<span class="cm-variable">num</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">total</span> <span class="cm-operator">=</span> <span class="cm-builtin">len</span>(<span class="cm-variable">labels</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">index</span> <span class="cm-operator">=</span> <span class="cm-builtin">list</span>(<span class="cm-builtin">range</span>(<span class="cm-variable">total</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">shuffle</span>(<span class="cm-variable">index</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">all_texts</span> <span class="cm-operator">=</span> []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">all_labels</span> <span class="cm-operator">=</span> []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">index</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">all_texts</span>.<span class="cm-property">append</span>(<span class="cm-variable">texts</span>[<span class="cm-variable">i</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">all_labels</span>.<span class="cm-property">append</span>(<span class="cm-variable">labels</span>[<span class="cm-variable">i</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">label2id</span> <span class="cm-operator">=</span> {}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">total</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-builtin">str</span>(<span class="cm-variable">all_labels</span>[<span class="cm-variable">i</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">if</span> <span class="cm-variable">label</span> <span class="cm-keyword">not</span> <span class="cm-keyword">in</span> <span class="cm-variable">label2id</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">label2id</span>[<span class="cm-variable">label</span>] <span class="cm-operator">=</span> [<span class="cm-variable">i</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">else</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">label2id</span>[<span class="cm-variable">label</span>].<span class="cm-property">append</span>(<span class="cm-variable">i</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">all_index</span> <span class="cm-operator">=</span> [[] <span class="cm-keyword">for</span> <span class="cm-variable">_</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">fold_num</span>)]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">for</span> <span class="cm-variable">label</span>, <span class="cm-variable">data</span> <span class="cm-keyword">in</span> <span class="cm-variable">label2id</span>.<span class="cm-property">items</span>():</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment"># print(label, len(data))</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">batch_size</span> <span class="cm-operator">=</span> <span class="cm-builtin">int</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">data</span>) <span class="cm-operator">/</span> <span class="cm-variable">fold_num</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">36</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">other</span> <span class="cm-operator">=</span> <span class="cm-builtin">len</span>(<span class="cm-variable">data</span>) <span class="cm-operator">-</span> <span class="cm-variable">batch_size</span> <span class="cm-operator">*</span> <span class="cm-variable">fold_num</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">37</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">fold_num</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">38</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">cur_batch_size</span> <span class="cm-operator">=</span> <span class="cm-variable">batch_size</span> <span class="cm-operator">+</span> <span class="cm-number">1</span> <span class="cm-keyword">if</span> <span class="cm-variable">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable">other</span> <span class="cm-keyword">else</span> <span class="cm-variable">batch_size</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">39</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment"># print(cur_batch_size)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">40</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">batch_data</span> <span class="cm-operator">=</span> [<span class="cm-variable">data</span>[<span class="cm-variable">i</span> <span class="cm-operator">*</span> <span class="cm-variable">batch_size</span> <span class="cm-operator">+</span> <span class="cm-variable">b</span>] <span class="cm-keyword">for</span> <span class="cm-variable">b</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">cur_batch_size</span>)]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">41</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">all_index</span>[<span class="cm-variable">i</span>].<span class="cm-property">extend</span>(<span class="cm-variable">batch_data</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">42</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">43</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">batch_size</span> <span class="cm-operator">=</span> <span class="cm-builtin">int</span>(<span class="cm-variable">total</span> <span class="cm-operator">/</span> <span class="cm-variable">fold_num</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">44</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">other_texts</span> <span class="cm-operator">=</span> []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">45</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">other_labels</span> <span class="cm-operator">=</span> []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">46</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">other_num</span> <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">47</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">start</span> <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">48</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">for</span> <span class="cm-variable">fold</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">fold_num</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">49</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">num</span> <span class="cm-operator">=</span> <span class="cm-builtin">len</span>(<span class="cm-variable">all_index</span>[<span class="cm-variable">fold</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">50</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">texts</span> <span class="cm-operator">=</span> [<span class="cm-variable">all_texts</span>[<span class="cm-variable">i</span>] <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">all_index</span>[<span class="cm-variable">fold</span>]]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">51</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">labels</span> <span class="cm-operator">=</span> [<span class="cm-variable">all_labels</span>[<span class="cm-variable">i</span>] <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">all_index</span>[<span class="cm-variable">fold</span>]]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">52</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">53</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">if</span> <span class="cm-variable">num</span> <span class="cm-operator">&gt;</span> <span class="cm-variable">batch_size</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">54</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">fold_texts</span> <span class="cm-operator">=</span> <span class="cm-variable">texts</span>[:<span class="cm-variable">batch_size</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">55</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">other_texts</span>.<span class="cm-property">extend</span>(<span class="cm-variable">texts</span>[<span class="cm-variable">batch_size</span>:])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">56</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">fold_labels</span> <span class="cm-operator">=</span> <span class="cm-variable">labels</span>[:<span class="cm-variable">batch_size</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">57</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">other_labels</span>.<span class="cm-property">extend</span>(<span class="cm-variable">labels</span>[<span class="cm-variable">batch_size</span>:])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">58</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">other_num</span> <span class="cm-operator">+=</span> <span class="cm-variable">num</span> <span class="cm-operator">-</span> <span class="cm-variable">batch_size</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">59</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">elif</span> <span class="cm-variable">num</span> <span class="cm-operator">&lt;</span> <span class="cm-variable">batch_size</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">60</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">end</span> <span class="cm-operator">=</span> <span class="cm-variable">start</span> <span class="cm-operator">+</span> <span class="cm-variable">batch_size</span> <span class="cm-operator">-</span> <span class="cm-variable">num</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">61</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">fold_texts</span> <span class="cm-operator">=</span> <span class="cm-variable">texts</span> <span class="cm-operator">+</span> <span class="cm-variable">other_texts</span>[<span class="cm-variable">start</span>: <span class="cm-variable">end</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">62</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">fold_labels</span> <span class="cm-operator">=</span> <span class="cm-variable">labels</span> <span class="cm-operator">+</span> <span class="cm-variable">other_labels</span>[<span class="cm-variable">start</span>: <span class="cm-variable">end</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">63</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">start</span> <span class="cm-operator">=</span> <span class="cm-variable">end</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">64</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">else</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">65</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">fold_texts</span> <span class="cm-operator">=</span> <span class="cm-variable">texts</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">66</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">fold_labels</span> <span class="cm-operator">=</span> <span class="cm-variable">labels</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">67</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">68</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">assert</span> <span class="cm-variable">batch_size</span> <span class="cm-operator">==</span> <span class="cm-builtin">len</span>(<span class="cm-variable">fold_labels</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">69</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">70</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment"># shuffle</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">71</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">index</span> <span class="cm-operator">=</span> <span class="cm-builtin">list</span>(<span class="cm-builtin">range</span>(<span class="cm-variable">batch_size</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">72</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">shuffle</span>(<span class="cm-variable">index</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">73</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">74</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">shuffle_fold_texts</span> <span class="cm-operator">=</span> []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">75</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">shuffle_fold_labels</span> <span class="cm-operator">=</span> []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">76</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">index</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">77</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">shuffle_fold_texts</span>.<span class="cm-property">append</span>(<span class="cm-variable">fold_texts</span>[<span class="cm-variable">i</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">78</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">shuffle_fold_labels</span>.<span class="cm-property">append</span>(<span class="cm-variable">fold_labels</span>[<span class="cm-variable">i</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">79</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">80</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data</span> <span class="cm-operator">=</span> {<span class="cm-string">'label'</span>: <span class="cm-variable">shuffle_fold_labels</span>, <span class="cm-string">'text'</span>: <span class="cm-variable">shuffle_fold_texts</span>}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">81</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">fold_data</span>.<span class="cm-property">append</span>(<span class="cm-variable">data</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">82</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">83</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">logging</span>.<span class="cm-property">info</span>(<span class="cm-string">"Fold lens %s"</span>, <span class="cm-builtin">str</span>([<span class="cm-builtin">len</span>(<span class="cm-variable">data</span>[<span class="cm-string">'label'</span>]) <span class="cm-keyword">for</span> <span class="cm-variable">data</span> <span class="cm-keyword">in</span> <span class="cm-variable">fold_data</span>]))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">84</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">85</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">fold_data</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">86</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">87</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">88</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fold_data</span> <span class="cm-operator">=</span> <span class="cm-variable">all_data2fold</span>(<span class="cm-number">10</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 1506px;"></div><div class="CodeMirror-gutters" style="left: 0px; height: 1536px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="p-Widget p-Panel jp-Cell-outputWrapper"><div class="p-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="p-Widget jp-OutputArea jp-Cell-outputArea"><div class="p-Widget p-Panel jp-OutputArea-child"><div class="p-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="p-Widget jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>2020-07-18 23:30:04,912 INFO: Fold lens [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]
</pre></div></div></div></div><div class="p-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="p-Widget jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-collapsed jp-mod-readOnly"><div class="p-Widget jp-Cell-header"></div><div class="p-Widget p-Panel jp-Cell-inputWrapper"><div class="p-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="p-Widget jp-InputArea jp-Cell-inputArea"><div class="p-Widget jp-InputPrompt jp-InputArea-prompt">[3]:</div><div class="p-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="CodeMirror cm-s-jupyter CodeMirror-wrap jp-mod-readOnly"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 43px;"><textarea autocorrect="false" autocapitalize="false" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 38px; margin-bottom: 0px; border-right-width: 30px; min-height: 163px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>9</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># build train data for word2vec</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fold_id</span> <span class="cm-operator">=</span> <span class="cm-number">9</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">train_texts</span> <span class="cm-operator">=</span> []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">0</span>, <span class="cm-variable">fold_id</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">fold_data</span>[<span class="cm-variable">i</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">train_texts</span>.<span class="cm-property">extend</span>(<span class="cm-variable">data</span>[<span class="cm-string">'text'</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">logging</span>.<span class="cm-property">info</span>(<span class="cm-string">'Total %d docs.'</span> <span class="cm-operator">%</span> <span class="cm-builtin">len</span>(<span class="cm-variable">train_texts</span>))</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 163px;"></div><div class="CodeMirror-gutters" style="left: 0px; height: 193px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="p-Widget p-Panel jp-Cell-outputWrapper"><div class="p-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="p-Widget jp-OutputArea jp-Cell-outputArea"><div class="p-Widget p-Panel jp-OutputArea-child"><div class="p-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="p-Widget jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>2020-07-18 23:30:04,929 INFO: Total 9000 docs.
</pre></div></div></div></div><div class="p-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="p-Widget jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-collapsed jp-mod-readOnly"><div class="p-Widget jp-Cell-header"></div><div class="p-Widget p-Panel jp-Cell-inputWrapper"><div class="p-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="p-Widget jp-InputArea jp-Cell-inputArea"><div class="p-Widget jp-InputPrompt jp-InputArea-prompt">[4]:</div><div class="p-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="CodeMirror cm-s-jupyter CodeMirror-wrap jp-mod-readOnly"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 43px;"><textarea autocorrect="false" autocapitalize="false" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 38px; margin-bottom: 0px; border-right-width: 30px; min-height: 214px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>12</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">logging</span>.<span class="cm-property">info</span>(<span class="cm-string">'Start training...'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">gensim</span>.<span class="cm-property">models</span>.<span class="cm-property">word2vec</span> <span class="cm-keyword">import</span> <span class="cm-variable">Word2Vec</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">num_features</span> <span class="cm-operator">=</span> <span class="cm-number">100</span> &nbsp; &nbsp; <span class="cm-comment"># Word vector dimensionality</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">num_workers</span> <span class="cm-operator">=</span> <span class="cm-number">8</span> &nbsp; &nbsp; &nbsp; <span class="cm-comment"># Number of threads to run in parallel</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">train_texts</span> <span class="cm-operator">=</span> <span class="cm-builtin">list</span>(<span class="cm-builtin">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-builtin">list</span>(<span class="cm-variable">x</span>.<span class="cm-property">split</span>()), <span class="cm-variable">train_texts</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span> <span class="cm-operator">=</span> <span class="cm-variable">Word2Vec</span>(<span class="cm-variable">train_texts</span>, <span class="cm-variable">workers</span><span class="cm-operator">=</span><span class="cm-variable">num_workers</span>, <span class="cm-variable">size</span><span class="cm-operator">=</span><span class="cm-variable">num_features</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span>.<span class="cm-property">init_sims</span>(<span class="cm-variable">replace</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># save model</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span>.<span class="cm-property">save</span>(<span class="cm-string">"./word2vec.bin"</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 214px;"></div><div class="CodeMirror-gutters" style="left: 0px; height: 244px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="p-Widget p-Panel jp-Cell-outputWrapper"><div class="p-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="p-Widget jp-OutputArea jp-Cell-outputArea"><div class="p-Widget p-Panel jp-OutputArea-child"><div class="p-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="p-Widget jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>2020-07-18 23:30:04,938 INFO: Start training...

2020-07-18 23:30:05,545 INFO: collecting all words and their counts

2020-07-18 23:30:05,546 INFO: PROGRESS: at sentence #0, processed 0 words, keeping 0 word types

2020-07-18 23:30:06,231 INFO: collected 5295 word types from a corpus of 8191447 raw words and 9000 sentences

2020-07-18 23:30:06,231 INFO: Loading a fresh vocabulary

2020-07-18 23:30:06,305 INFO: effective_min_count=5 retains 4335 unique words (81% of original 5295, drops 960)

2020-07-18 23:30:06,305 INFO: effective_min_count=5 leaves 8189498 word corpus (99% of original 8191447, drops 1949)

2020-07-18 23:30:06,314 INFO: deleting the raw counts dictionary of 5295 items

2020-07-18 23:30:06,316 INFO: sample=0.001 downsamples 61 most-common words

2020-07-18 23:30:06,316 INFO: downsampling leaves estimated 7070438 word corpus (86.3% of prior 8189498)

2020-07-18 23:30:06,324 INFO: estimated required memory for 4335 words and 100 dimensions: 5635500 bytes

2020-07-18 23:30:06,325 INFO: resetting layer weights

2020-07-18 23:30:06,356 INFO: training model with 8 workers on 4335 vocabulary and 100 features, using sg=0 hs=0 sample=0.001 negative=5 window=5

2020-07-18 23:30:07,360 INFO: EPOCH 1 - PROGRESS: at 63.20% examples, 4434412 words/s, in_qsize 15, out_qsize 0

2020-07-18 23:30:07,959 INFO: worker thread finished; awaiting finish of 7 more threads

2020-07-18 23:30:07,960 INFO: worker thread finished; awaiting finish of 6 more threads

2020-07-18 23:30:07,963 INFO: worker thread finished; awaiting finish of 5 more threads

2020-07-18 23:30:07,963 INFO: worker thread finished; awaiting finish of 4 more threads

2020-07-18 23:30:07,964 INFO: worker thread finished; awaiting finish of 3 more threads

2020-07-18 23:30:07,965 INFO: worker thread finished; awaiting finish of 2 more threads

2020-07-18 23:30:07,968 INFO: worker thread finished; awaiting finish of 1 more threads

2020-07-18 23:30:07,969 INFO: worker thread finished; awaiting finish of 0 more threads

2020-07-18 23:30:07,970 INFO: EPOCH - 1 : training on 8191447 raw words (7021120 effective words) took 1.6s, 4357567 effective words/s

2020-07-18 23:30:08,979 INFO: EPOCH 2 - PROGRESS: at 59.39% examples, 4143643 words/s, in_qsize 15, out_qsize 0

2020-07-18 23:30:09,661 INFO: worker thread finished; awaiting finish of 7 more threads

2020-07-18 23:30:09,663 INFO: worker thread finished; awaiting finish of 6 more threads

2020-07-18 23:30:09,663 INFO: worker thread finished; awaiting finish of 5 more threads

2020-07-18 23:30:09,664 INFO: worker thread finished; awaiting finish of 4 more threads

2020-07-18 23:30:09,667 INFO: worker thread finished; awaiting finish of 3 more threads

2020-07-18 23:30:09,667 INFO: worker thread finished; awaiting finish of 2 more threads

2020-07-18 23:30:09,670 INFO: worker thread finished; awaiting finish of 1 more threads

2020-07-18 23:30:09,672 INFO: worker thread finished; awaiting finish of 0 more threads

2020-07-18 23:30:09,672 INFO: EPOCH - 2 : training on 8191447 raw words (7021506 effective words) took 1.7s, 4144060 effective words/s

2020-07-18 23:30:10,681 INFO: EPOCH 3 - PROGRESS: at 59.52% examples, 4154672 words/s, in_qsize 15, out_qsize 0

2020-07-18 23:30:11,356 INFO: worker thread finished; awaiting finish of 7 more threads

2020-07-18 23:30:11,356 INFO: worker thread finished; awaiting finish of 6 more threads

2020-07-18 23:30:11,358 INFO: worker thread finished; awaiting finish of 5 more threads

2020-07-18 23:30:11,359 INFO: worker thread finished; awaiting finish of 4 more threads

2020-07-18 23:30:11,362 INFO: worker thread finished; awaiting finish of 3 more threads

2020-07-18 23:30:11,362 INFO: worker thread finished; awaiting finish of 2 more threads

2020-07-18 23:30:11,365 INFO: worker thread finished; awaiting finish of 1 more threads

2020-07-18 23:30:11,366 INFO: worker thread finished; awaiting finish of 0 more threads

2020-07-18 23:30:11,367 INFO: EPOCH - 3 : training on 8191447 raw words (7020706 effective words) took 1.7s, 4163417 effective words/s

2020-07-18 23:30:12,378 INFO: EPOCH 4 - PROGRESS: at 58.80% examples, 4102329 words/s, in_qsize 15, out_qsize 0

2020-07-18 23:30:13,072 INFO: worker thread finished; awaiting finish of 7 more threads

2020-07-18 23:30:13,078 INFO: worker thread finished; awaiting finish of 6 more threads

2020-07-18 23:30:13,079 INFO: worker thread finished; awaiting finish of 5 more threads

2020-07-18 23:30:13,079 INFO: worker thread finished; awaiting finish of 4 more threads

2020-07-18 23:30:13,080 INFO: worker thread finished; awaiting finish of 3 more threads

2020-07-18 23:30:13,080 INFO: worker thread finished; awaiting finish of 2 more threads

2020-07-18 23:30:13,081 INFO: worker thread finished; awaiting finish of 1 more threads

2020-07-18 23:30:13,082 INFO: worker thread finished; awaiting finish of 0 more threads

2020-07-18 23:30:13,083 INFO: EPOCH - 4 : training on 8191447 raw words (7021984 effective words) took 1.7s, 4117851 effective words/s

2020-07-18 23:30:14,091 INFO: EPOCH 5 - PROGRESS: at 58.99% examples, 4115963 words/s, in_qsize 16, out_qsize 0

2020-07-18 23:30:14,769 INFO: worker thread finished; awaiting finish of 7 more threads

2020-07-18 23:30:14,770 INFO: worker thread finished; awaiting finish of 6 more threads

2020-07-18 23:30:14,770 INFO: worker thread finished; awaiting finish of 5 more threads

2020-07-18 23:30:14,771 INFO: worker thread finished; awaiting finish of 4 more threads

2020-07-18 23:30:14,773 INFO: worker thread finished; awaiting finish of 3 more threads

2020-07-18 23:30:14,776 INFO: worker thread finished; awaiting finish of 2 more threads

2020-07-18 23:30:14,777 INFO: worker thread finished; awaiting finish of 1 more threads

2020-07-18 23:30:14,779 INFO: worker thread finished; awaiting finish of 0 more threads

2020-07-18 23:30:14,779 INFO: EPOCH - 5 : training on 8191447 raw words (7021532 effective words) took 1.7s, 4156171 effective words/s

2020-07-18 23:30:14,780 INFO: training on a 40957235 raw words (35106848 effective words) took 8.4s, 4167675 effective words/s

2020-07-18 23:30:14,780 INFO: precomputing L2-norms of word weight vectors

2020-07-18 23:30:14,782 INFO: saving Word2Vec object under ./word2vec.bin, separately None

2020-07-18 23:30:14,783 INFO: not storing attribute vectors_norm

2020-07-18 23:30:14,783 INFO: not storing attribute cum_table

2020-07-18 23:30:14,820 INFO: saved ./word2vec.bin
</pre></div></div></div></div><div class="p-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="p-Widget jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-collapsed jp-mod-readOnly"><div class="p-Widget jp-Cell-header"></div><div class="p-Widget p-Panel jp-Cell-inputWrapper"><div class="p-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="p-Widget jp-InputArea jp-Cell-inputArea"><div class="p-Widget jp-InputPrompt jp-InputArea-prompt">[5]:</div><div class="p-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="CodeMirror cm-s-jupyter CodeMirror-wrap jp-mod-readOnly"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5px; left: 43px;"><textarea autocorrect="false" autocapitalize="false" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="height: 18px; pointer-events: none;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 38px; margin-bottom: 0px; border-right-width: 30px; min-height: 95px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># load model</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span> <span class="cm-operator">=</span> <span class="cm-variable">Word2Vec</span>.<span class="cm-property">load</span>(<span class="cm-string">"./word2vec.bin"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># convert format</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -38px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">model</span>.<span class="cm-property">wv</span>.<span class="cm-property">save_word2vec_format</span>(<span class="cm-string">'./word2vec.txt'</span>, <span class="cm-variable">binary</span><span class="cm-operator">=</span><span class="cm-keyword">False</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent; top: 95px;"></div><div class="CodeMirror-gutters" style="left: 0px; height: 125px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="p-Widget p-Panel jp-Cell-outputWrapper"><div class="p-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="p-Widget jp-OutputArea jp-Cell-outputArea"><div class="p-Widget p-Panel jp-OutputArea-child"><div class="p-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="p-Widget jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>2020-07-18 23:30:14,825 INFO: loading Word2Vec object from ./word2vec.bin

2020-07-18 23:30:14,958 INFO: loading wv recursively from ./word2vec.bin.wv.* with mmap=None

2020-07-18 23:30:14,958 INFO: setting ignored attribute vectors_norm to None

2020-07-18 23:30:14,959 INFO: loading vocabulary recursively from ./word2vec.bin.vocabulary.* with mmap=None

2020-07-18 23:30:14,959 INFO: loading trainables recursively from ./word2vec.bin.trainables.* with mmap=None

2020-07-18 23:30:14,959 INFO: setting ignored attribute cum_table to None

2020-07-18 23:30:14,959 INFO: loaded ./word2vec.bin

2020-07-18 23:30:14,965 INFO: storing 4335x100 projection weights into ./word2vec.txt
</pre></div></div></div></div><div class="p-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="p-Widget jp-Cell jp-MarkdownCell jp-Notebook-cell jp-mod-rendered jp-mod-readOnly"><div class="p-Widget jp-Cell-header"></div><div class="p-Widget p-Panel jp-Cell-inputWrapper"><div class="p-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="p-Widget jp-InputArea jp-Cell-inputArea"><div class="p-Widget jp-InputPrompt jp-InputArea-prompt"></div><div class="p-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor p-mod-hidden" data-type="inline"><div><div class="md-Toolbar"><span class=""><div class="ant-upload ant-upload-select ant-upload-select-text"><span tabindex="0" class="ant-upload" role="button"><input type="file" accept="" style="display: none;"><i class="jp-Icon md-Icon-16 my-toolbaricon md-imageIcon"></i></span></div></span><i class="jp-Icon md-Icon-16 my-toolbaricon md-tableIcon"></i><i class="jp-Icon md-Icon-16 my-toolbaricon  md-mathIcon"></i></div></div><div class="CodeMirror cm-s-jupyter CodeMirror-wrap jp-mod-readOnly"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 0px;"><textarea autocorrect="false" autocapitalize="false" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="display: block; bottom: 0px;"><div style="min-width: 1px; height: 113px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-strong">**关于Datawhale：**</span></span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code" role="presentation"></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; border-bottom: 0px solid transparent;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="p-Widget jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown"><p><strong>关于Datawhale：</strong></p>
<blockquote>
<p>Datawhale是一个专注于数据科学与AI领域的开源组织，汇集了众多领域院校和知名企业的优秀学习者，聚合了一群有开源精神和探索精神的团队成员。Datawhale 以“for the learner，和学习者一起成长”为愿景，鼓励真实地展现自我、开放包容、互信互助、敢于试错和勇于担当。同时 Datawhale 用开源的理念去探索开源内容、开源学习和开源方案，赋能人才培养，助力人才成长，建立起人与人，人与知识，人与企业和人与未来的联结。</p>
</blockquote>
<p>本次新闻文本分类学习，专题知识将在天池分享，详情可关注Datawhale：</p>
<p> <img alt="Image" src="./1584432602983_kAxAvgQpG2.jpg"></p>
</div></div></div><div class="p-Widget jp-CellFooter jp-Cell-footer"></div></div></div></div></div></div></div></div></div></div></div>
  
  <script src="./app.57a1d40bb6.js"></script>
  <script src="./vendor.7aa1590a16.js"></script>


</body></html>